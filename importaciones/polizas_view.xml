<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="polizas_view" model="ir.ui.view">
            <field name="name">polizas.view</field>
            <field name="model">importaciones.poliza</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Poliza">
                    <field name="name"/>
                    <field name="company_id"/>
                    <field name="poliza_aduana"/>
                    <field name="fecha"/>
                </tree>
            </field>
        </record>

        <record id="linea_polizas_view" model="ir.ui.view">
            <field name="name">linea.polizas.view</field>
            <field name="model">importaciones.poliza.linea</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Linea poliza">
                    <group col="6" colspan="4">
                        <field name="producto_id"/>
                        <field name="cantidad"/>
                        <field name="precio"/>
                        <field name="costo_proyectado"/>
                        <field name="costo"/>
                        <field name="impuestos"/>
                        <field name="porcentage_gasto"/>
                        <field name="porcentage_gasto_importacion"/>
                    </group>
                    <group col="2" colspan="4">
                        <field name="impuestos_importacion"/>
                        <field name="gastos"/>
                        <field name="documentos"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="polizas_view_form" model="ir.ui.view">
            <field name="name">polizas.view</field>
            <field name="model">importaciones.poliza</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Poliza">
                    <group col="6" colspan="4">
                        <field name="name"/>
                        <field name="poliza_aduana"/>
                        <field name="guia"/>
                        <field name="moneda"/>
                        <field name="tasa"/>
                        <field name="moneda_base"/>
                        <field name="fecha"/>
                        <field name="tipo_importacion"/>
                        <field name="transportista"/>
                        <field name="company_id" widget="selection"/>
                        <field name="comentario"/>
                    </group>
                    <notebook colspan="4">
                        <page string="Compras">
                            <group col="4" colspan="4">
                                <field name="compras" nolabel="1">
                                </field>
                            </group>
                        </page>

                        <page string="Gastos proyectados">
                            <group col="4" colspan="4">
                                <field name="gastos_proyectados" nolabel="1">
                                </field>
                            </group>
                            <group col="2" colspan="2">
                                <button name="asignar_gastos" string="Asignar gastos a todos los productos" icon="gtk-ok" type="object"/>
                            </group>
                        </page>

                        <page string="Documentos asociados">
                            <group col="4" colspan="4">
                                <field name="documentos_asociados" nolabel="1">
                                </field>
                            </group>
                            <group col="2" colspan="2">
                                <button name="asignar_facturas" string="Asignar facturas a todos los productos" icon="gtk-ok" type="object"/>
                            </group>
                        </page>

                        <page string="Lineas">
                            <group col="4" colspan="4">
                                <field name="lineas" nolabel="1">
                                    <tree string="Lineas">
                                        <field name="producto_id"/>
                                        <field name="pedido"/>
                                        <field name="total_factura" sum="total_factura"/>
                                        <field name="impuestos_importacion"/>
                                        <field name="cantidad"/>
                                        <field name="precio"/>
                                        <field name="total_gastos" sum="total_gastos"/>
                                        <field name="total_gastos_importacion" sum="total_gastos_importacion"/>
                                        <field name="impuestos" sum="impuestos"/>
                                        <field name="costo" sum="costo" string="Costo unit."/>
                                        <field name="costo_proyectado" sum="costo_proyectado"/>
                                        <field name="diferencia_costos" sum="diferencia_costos"/>
                                        <field name="total" sum="total"/>
                                    </tree>
                                </field>
                            </group>
                            <group col="3" colspan="2">
                                <button name="generar_lineas" string="Generar lineas" icon="gtk-ok" type="object"/>
                                <button name="prorrateo_costo" string="Prorrateo" icon="gtk-ok" type="object"/>
                                <button name="asignar_costo_albaranes" string="Asignar costos" icon="gtk-ok" type="object"/>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="action_polizas_form" model="ir.actions.act_window">
            <field name="name">Polizas</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">importaciones.poliza</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="polizas_view"/>
        </record>
        <menuitem id="menu_polizas_form" action="action_polizas_form" parent="purchase.menu_procurement_management"/>

        <report auto="False" id="reporte_poliza" model="importaciones.poliza" name="poliza" rml="importaciones/reportes/poliza.rml" string="Poliza"/>

    </data>
</openerp>
